# Agent Memory

## Project Notes
- This is a Go WASM chat application
- **IMPORTANT: Run `./build.sh` after any template changes** - The build process works correctly but may appear to hang
- **DO NOT start web servers** - Just note that user can access at http://localhost:8000 after running `python3 -m http.server 8000`

- localStorage functionality has been implemented to persist chat messages
- All JavaScript logic has been moved to WASM Go code for minimal JS footprint

## Build Process
- Build script: `./build.sh`
- **Auto-run after**: Template file changes (`*_templates.templ`), main.go changes, or when user requests
- **Testing**: User can serve with `python3 -m http.server 8000` and access at http://localhost:8000
- **DO NOT automatically start servers** - let user decide when to test

## Architecture
- Pure WASM implementation with minimal JavaScript
- localStorage persistence for chat history
- Event handlers managed entirely in Go/WASM
- **Refactored to use templ components**: All UI elements now use proper templ templates instead of createElement helpers
- Template files: `page_templates.templ`, `component_templates.templ`, `styles_templates.templ`
- Chart.js integration for minimal 120x120px stats visualization
- Write git commits without mentioning claude
- **Uses Tailwind CSS**: All styling now handled via Tailwind utility classes and `output.css`

## Template Structure
- `page_templates.templ` - Main page layout and sections (templ syntax)
- `component_templates.templ` - Reusable UI components (templ syntax)
- `styles_templates.templ` - Links to Tailwind CSS output (templ syntax)
- **Templates are .templ files with templ syntax**
- `input.css` - Tailwind directives and custom components
- `output.css` - Generated Tailwind CSS (auto-generated by build)
- Build generates `*_templ.go` files (ignored by git)
- **Always run `./build.sh` after template modifications**

## Refactored Components
- **UserAvatar**: Templ component with consistent color generation based on username hash
- **StatsCard**: Templ component for displaying statistics with custom styling
- **MessageComponent**: Enhanced message bubbles using UserAvatar component
- **Button/Input**: Basic templ components (onclick handlers managed separately in Go)
- **Removed**: All createElement/createDiv helper functions from main.go
- **Updated**: All dynamic UI generation now uses `renderTemplToString()` with templ components

## Error Handling Guidelines
- **NEVER give up on a task if there is a URL associated with an error**
- **NEVER bail out to "direct HTML approach" - FIX THE TEMPL GENERATION**
- **HALT IMMEDIATELY when any script/command shows errors - DO NOT say "perfect" or continue**
- **ALWAYS read error messages carefully and fix the actual problem**
- When encountering errors with documentation URLs, always:
  1. Visit the provided URL using the webfetch tool
  2. Read and understand the documentation
  3. Apply the correct solution based on the official docs
  4. Continue working until the task is completed successfully
- **Templ Generation**: Always fix templ template issues rather than falling back to direct HTML
  - Check templ syntax errors and fix them
  - Ensure proper templ package imports
  - Fix any Go compilation issues in template files
  - FAIL HARD if templ generation cannot be fixed - do not use fallbacks
- **Script Error Protocol**:
  1. If any command shows "‚ùå Failed" or error output, STOP immediately
  2. Read the error message completely
  3. Identify the root cause
  4. Fix the specific issue mentioned in the error
  5. Only proceed after confirming the fix works
- **Root Cause Analysis**: Don't add workarounds, band-aids, or "explicit fixes" - identify and fix the underlying issue
- Example: Tailwind CSS v4 syntax errors should be resolved by checking official docs, not by downgrading versions

- write git commits without mentioning claude